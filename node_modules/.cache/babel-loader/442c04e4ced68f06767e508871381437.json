{"ast":null,"code":"import _asyncToGenerator from\"/Users/rengarrrrr/Desktop/Studies/movie/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rengarrrrr/Desktop/Studies/movie/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/rengarrrrr/Desktop/Studies/movie/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import{useDispatch}from\"react-redux\";import{useLocation}from\"react-router-dom\";import searchAPI from\"../../api/searchAPI\";// import { changeSearch } from \"../Slice/searchSlice\";\nimport SearchContent from\"./components/SearchContent\";import SearchFilter from\"./components/SearchFilter\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Search(props){var location=useLocation();// get params\nvar keyword=useSelector(function(state){return state.search.submit;});// keyword to search\nvar dispatch=useDispatch();var API_Key=process.env.REACT_APP_MOVIE_API;var _useState=useState(),_useState2=_slicedToArray(_useState,2),searchData=_useState2[0],setSearchData=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),searchFilter=_useState4[0],setSearchFilter=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),typeOfFilm=_useState6[0],setTypeOfFilm=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),selectType=_useState8[0],setSelectType=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),page=_useState10[0],setPage=_useState10[1];// useEffect(() => {\n//   if (!location) return;\n//           ;// get query string, path is ?query='querystring', first 7 letters need to slice\n//   const action = changeSearch(params)\n//   dispatch(action)\n// }, [location,dispatch]); // add keyword\nuseEffect(function(){if(!keyword)return;var fetchSearchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,newData,_newData,_newData2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return searchAPI.getSearchData(API_Key,keyword,page);case 2:data=_context.sent;if(!selectType){newData=data.data.results.filter(function(item){return item.media_type===\"tv\"||item.media_type===\"movie\";});setSearchData(newData);setSearchFilter(newData);}if(selectType&&selectType!==\"all\"){_newData=data.data.results.filter(function(item){return item.media_type===selectType;});setSearchFilter(_newData);}if(selectType===\"all\"){_newData2=data.data.results.filter(function(item){return item.media_type===\"tv\"||item.media_type===\"movie\";});setSearchFilter(_newData2);}case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchSearchData(){return _ref.apply(this,arguments);};}();fetchSearchData();},[keyword,API_Key,selectType,page]);// add data\nuseEffect(function(){if(!searchData)return;var typesSet={};for(var i=0;i<searchData.length;i++){if(searchData[i].media_type in typesSet){typesSet[searchData[i].media_type]+=1;}else{typesSet[searchData[i].media_type]=1;}}setTypeOfFilm(typesSet);},[searchData]);// get all types\nvar handleSelectType=function handleSelectType(value){setSelectType(value);};// set type\nvar handlePagination=function handlePagination(e){setTimeout(function(){window.scrollTo({top:0,behavior:'smooth'});},700);var currentPage=page;if(e.target.value===\"backward\"){currentPage-=1;if(currentPage<1)return;setPage(currentPage);}if(e.target.value===\"forward\"){if((searchData===null||searchData===void 0?void 0:searchData.length)===0)return;setPage(page+1);}};return/*#__PURE__*/_jsxs(\"section\",{className:\"search-container\",style:{width:\"90%\",margin:\"0 5%\",paddingTop:\"2rem\",position:\"relative\",top:\"4rem\",zIndex:1,display:\"flex\",justifyContent:\"space-between\",gap:\"2rem\",fontFamily:\"Source Sans Pro\"},children:[/*#__PURE__*/_jsx(SearchFilter,{typeOfFilm:typeOfFilm,total:searchData===null||searchData===void 0?void 0:searchData.length,handleSelectType:handleSelectType}),/*#__PURE__*/_jsx(SearchContent,{searchData:searchFilter,page:page,handlePagination:handlePagination})]});}export default Search;","map":{"version":3,"sources":["/Users/rengarrrrr/Desktop/Studies/movie/src/features/Search/index.jsx"],"names":["React","useEffect","useState","useSelector","useDispatch","useLocation","searchAPI","SearchContent","SearchFilter","Search","props","location","keyword","state","search","submit","dispatch","API_Key","process","env","REACT_APP_MOVIE_API","searchData","setSearchData","searchFilter","setSearchFilter","typeOfFilm","setTypeOfFilm","selectType","setSelectType","page","setPage","fetchSearchData","getSearchData","data","newData","results","filter","item","media_type","typesSet","i","length","handleSelectType","value","handlePagination","e","setTimeout","window","scrollTo","top","behavior","currentPage","target","width","margin","paddingTop","position","zIndex","display","justifyContent","gap","fontFamily"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useDispatch } from \"react-redux\";\nimport { useLocation } from \"react-router-dom\";\nimport searchAPI from \"../../api/searchAPI\";\n// import { changeSearch } from \"../Slice/searchSlice\";\nimport SearchContent from \"./components/SearchContent\";\nimport SearchFilter from \"./components/SearchFilter\";\n\nSearch.propTypes = {};\n\nfunction Search(props) {\n  const location = useLocation(); // get params\n  const keyword = useSelector(state => state.search.submit)// keyword to search\n\n  const dispatch = useDispatch()\n  \n  const API_Key = process.env.REACT_APP_MOVIE_API;\n\n  const [searchData, setSearchData] = useState();\n  const [searchFilter, setSearchFilter] = useState();\n\n  const [typeOfFilm, setTypeOfFilm] = useState();\n  const [selectType, setSelectType] = useState();\n\n  const [page, setPage] = useState(1);\n\n  // useEffect(() => {\n  //   if (!location) return;\n  //           ;// get query string, path is ?query='querystring', first 7 letters need to slice\n  //   const action = changeSearch(params)\n  //   dispatch(action)\n  // }, [location,dispatch]); // add keyword\n\n  useEffect(() => {\n    if (!keyword) return;\n    const fetchSearchData = async () => {\n      const data = await searchAPI.getSearchData(API_Key, keyword,page);\n      if (!selectType) {\n        const newData = data.data.results.filter(\n          (item) => item.media_type === \"tv\" || item.media_type === \"movie\"\n        );\n        setSearchData(newData);\n        setSearchFilter(newData);\n      }\n      if (selectType && selectType !== \"all\") {\n        const newData = data.data.results.filter(\n          (item) => item.media_type === selectType\n        );\n        setSearchFilter(newData);\n      }\n\n      if (selectType === \"all\") {\n        const newData = data.data.results.filter(\n          (item) => item.media_type === \"tv\" || item.media_type === \"movie\"\n        );\n        setSearchFilter(newData);\n      }\n    };\n    fetchSearchData();\n  }, [keyword, API_Key, selectType,page]); // add data\n\n  useEffect(() => {\n    if (!searchData) return;\n    const typesSet = {};\n    for (let i = 0; i < searchData.length; i++) {\n      if (searchData[i].media_type in typesSet) {\n        typesSet[searchData[i].media_type] += 1;\n      } else {\n        typesSet[searchData[i].media_type] = 1;\n      }\n    }\n\n    setTypeOfFilm(typesSet);\n  }, [searchData]); // get all types\n\n  const handleSelectType = (value) => {\n    setSelectType(value);\n  }; // set type\n\n  const handlePagination = (e) => {\n    setTimeout(()=> {\n      window.scrollTo({\n        top : 0,\n        behavior:'smooth'\n      })\n    },700)\n    let currentPage = page;\n    if (e.target.value === \"backward\") {\n      currentPage -= 1;\n      if (currentPage < 1) return;\n      setPage(currentPage);\n    }\n    if (e.target.value === \"forward\") {\n      if(searchData?.length === 0) return\n      setPage(page + 1);\n    }\n  }\n\n  return (\n    <section\n      className=\"search-container\"\n      style={{\n        width: \"90%\",\n        margin: \"0 5%\",\n        paddingTop: \"2rem\",\n        position: \"relative\",\n        top: \"4rem\",\n        zIndex: 1,\n\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        gap: \"2rem\",\n        fontFamily: \"Source Sans Pro\",\n      }}\n    >\n      <SearchFilter\n        typeOfFilm={typeOfFilm}\n        total={searchData?.length}\n        handleSelectType={handleSelectType}\n      />\n      <SearchContent searchData={searchFilter} page={page} handlePagination={handlePagination}/>\n    </section>\n  );\n}\n\nexport default Search;\n"]},"metadata":{},"sourceType":"module"}